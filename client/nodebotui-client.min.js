var nodebotui=function(){function a(a){return!isNaN(parseFloat(a))&&isFinite(a)}function b(a){return c(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a}function c(a,b,c){var e;if(null!==a)if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(b,c);else if(a.length===+a.length){for(e=0,length=a.length;length>e;e++)if(b.call(c,a[e],e,a)==={})return}else{var f=d(a);for(e=0,length=f.length;length>e;e++)if(b.call(c,a[f[e]],f[e],a)==={})return}}function d(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)hasOwnProperty.call(a,c)&&b.push(c);return b}function e(){var a,b={},c=document.getElementsByTagName("form");for(a=0;a<c.length;a++)"board"===c[a].getAttribute("data-device-type")&&(b[c[a].id]=new j(c[a].attributes));return b}var f,g,h={},j=function(a){return this instanceof j?(this._extendAttributes(a),this.getControls(a.id.nodeValue),void 0):new j(a)};j.prototype.getControls=function(a){var b=document.getElementById(this.id).getElementsByTagName("input");for(i=0;i<b.length;i++)b[i].hasAttribute("data-device-type")&&(this[b[i].id]=new k(b[i].attributes,a));var c=document.getElementById(this.id).getElementsByTagName("fieldset");for(i=0;i<c.length;i++)c[i].hasAttribute("data-device-type")&&(this["_"+c[i].id]=new k(c[i].attributes,a))},j.prototype.initialize=function(){c(this,function(a,b){"_"!==b.substring(0,1)&&a._initialize&&a._initialize()})},j.prototype._extendAttributes=function(a){var c,d,e={};for(c=0,d=a.length;d>c;c++)e[a.item(c).nodeName.replace("data-","")]=a.item(c).nodeValue;b(this,e)};var k=function(a,d){if(!(this instanceof k))return new k(a);var e=document.getElementById(a.id.nodeValue);this._board=d,this._ready=!1,this._extendAttributes(a),b(this,n[this["device-type"]],l[this["device-type"]],o[this.type]),this._extendAttributes(a),this._methods&&c(this._methods,function(a){this[a]=m[a]},this),delete this._methods,this._initialize&&this._initialize(e,this),this._listen&&this._listen(e,this)};k.prototype._extendAttributes=function(c){var d,e,f,g={};for(d=0,e=c.length;e>d;d++)f=c.item(d).nodeValue,g[c.item(d).nodeName.replace("data-","")]=a(f)?Number(f):f;b(this,g)};var l={Led:{min:0,max:255,_methods:["on","off"]},Servo:{min:0,max:180,tolerance:0,_lastUpdate:-999,_methods:["move"]}},m={on:function(){f&&f.emit("call",{board:this._board,device:this.id,method:"on"}),this._update(!0)},off:function(){f&&f.emit("call",{board:this._board,device:this.id,method:"off"}),this._update(!1)},move:function(a){(null===a||"undefined"==typeof a)&&(a=Number(document.getElementById(this.id).value));var b=(a-this.inputMin)/(this.inputMax-this.inputMin);0>b&&(b=0),b>1&&(b=1),this.inverse&&(b=1-b);var c=b*(this.max-this.min)+this.min;this.easing&&(c=h[this.easing](c)),f&&g[this._board]._ready&&Number(this.tolerance)<=Math.abs(c-this._lastUpdate)&&(this._lastUpdate=c,f.emit("call",{board:this._board,device:this.id,method:"move",params:c})),this._update(a)}},n={Orientation:{_listen:function(a,b){window.addEventListener("deviceorientation",function(a){c(["alpha","beta","gamma"],function(b){this[b+"Input"]&&g[this._board][this[b+"Input"]].move(a[b])},b)})},_update:function(){},_initialize:function(){var a=document.getElementById(this.id).getElementsByTagName("input");for(i=0;i<a.length;i++)a[i].hasAttribute("data-axis")&&(this[a[i].getAttribute("data-axis")+"Input"]=a[i].id)}}},o={checkbox:{_listen:function(a,b){a.addEventListener("change",function(){a.checked?b.on():b.off()})},_update:function(a){document.getElementById(this.id).checked=a}},range:{_listen:function(a,b){a.addEventListener("change",function(){b.move()})},_update:function(a){document.getElementById(this.id).value=a},_initialize:function(){var a=document.getElementById(this.id);if(this.max=Number(a.getAttribute("max"))||this.max,a.setAttribute("max",this.max),this.min=Number(a.getAttribute("min"))||this.min,a.setAttribute("min",this.min),this.thresholds){var b=this.thresholds.split(",");this.inputMin=Number(b[0]),this.inputMax=Number(b[1])}else this.inputMin=this.min,this.inputMax=this.max}}},n={Orientation:{_listen:function(a,b){window.addEventListener("deviceorientation",function(a){c(["alpha","beta","gamma"],function(b){this[b+"Input"]&&g[this._board][this[b+"Input"]].move(a[b])},b)})},_update:function(){},_initialize:function(){var a=document.getElementById(this.id).getElementsByTagName("input");for(i=0;i<a.length;i++)a[i].hasAttribute("data-axis")&&(this[a[i].getAttribute("data-axis")+"Input"]=a[i].id)}}},p={};c(["Quad","Cubic","Quart","Quint","Expo"],function(a,b){p[a]=function(a){return Math.pow(a,b+2)}}),b(p,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),c(p,function(a,b){h["easeIn"+b]=a,h["easeOut"+b]=function(b){return 1-a(1-b)},h["easeInOut"+b]=function(b){return.5>b?a(2*b)/2:1-a(-2*b+2)/2}});var q=document.createElement("script");q.type="text/javascript",q.async=!0;for(var r,s,t=document.getElementsByTagName("script"),u=t.length,v=/nodebotui-client\.js$/;u--;)if(r=t[u].src,r&&r.match(v)){s=r;break}return q.onload=function(){f=io.connect(),f.on("connect",function(){console.log("connect"),c(g,function(a){f.emit("new board",a)})}),f.on("board ready",function(a){console.log("board ready"),g[a.id]._ready=!0,g[a.id].initialize()})},q.src="socket.io/socket.io.js",document.getElementsByTagName("head")[0].appendChild(q),g=e()}();